{% extends 'inicio/base_admin.html' %}
{% block titulo %}Arrendatarios{% endblock %}

{% block contenido %}
<div class="space-y-6 animate-fade-in">

  <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">
    <div>
      <h1 class="text-3xl font-bold text-gradient">Arrendatarios {{ estado|title }}</h1>
      <p class="text-sm text-gray-300 mt-1">Gestiona altas, bajas y ediciones de arrendatarios.</p>
    </div>

    <a href="{% url 'crear_arrendatario' %}"
       class="px-4 py-2 rounded-lg bg-indigo-600 hover:bg-indigo-500 text-white text-sm font-medium shadow-md">
      ➕ Crear arrendatario
    </a>
  </div>

  <form method="get" class="flex flex-wrap gap-3">
    <select name="estado"
            class="bg-gray-700 text-white rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-pink-500 shadow-inner">
      <option value="activos" {% if estado == 'activos' %}selected{% endif %}>Activos</option>
      <option value="inactivos" {% if estado == 'inactivos' %}selected{% endif %}>Inactivos</option>
    </select>

    <input type="text" name="q" placeholder="Buscar por usuario, nombre, email o teléfono"
           value="{{ q }}"
           class="flex-1 min-w-[240px] bg-gray-700 text-white rounded-lg px-3 py-2 text-sm placeholder-gray-400
                  focus:outline-none focus:ring-2 focus:ring-pink-500 shadow-inner">

    <button type="submit"
            class="px-4 py-2 bg-indigo-500 hover:bg-indigo-600 text-white rounded-lg text-sm font-medium shadow-md transition">
      Filtrar
    </button>
  </form>

  <div class="bg-gray-900/70 rounded-lg border border-white/10 shadow-lg overflow-x-auto">
    <table class="min-w-full text-sm table-fixed">
      <thead class="bg-white/5 text-gray-300 uppercase tracking-wide text-xs">
        <tr>
          <th class="px-4 py-3 text-left w-3/12">Usuario</th>
          <th class="px-4 py-3 text-left w-3/12">Nombre completo</th>
          <th class="px-4 py-3 text-left w-3/12">Email</th>
          <th class="px-4 py-3 text-left w-2/12">Teléfono</th>
          <th class="px-4 py-3 text-left w-1/12">Estado</th>
          <th class="px-4 py-3 text-center w-2/12">Acciones</th>
        </tr>
      </thead>
      <tbody class="divide-y divide-white/5">
        {% for perfil in arrendatarios %}
        <tr class="hover:bg-white/5 transition-colors">
          <td class="px-4 py-3 text-gray-200">{{ perfil.user.username }}</td>
          <td class="px-4 py-3 text-gray-200">
            {{ perfil.user.get_full_name|default:perfil.user.username }}
          </td>
          <td class="px-4 py-3 text-gray-200">{{ perfil.user.email|default:"—" }}</td>
          <td class="px-4 py-3 text-gray-200">{{ perfil.telefono|default:"—" }}</td>
          <td class="px-4 py-3 text-gray-200">
            {% if perfil.user.is_active %}
              <span class="px-2 py-1 text-xs rounded-full bg-green-500/20 text-green-300 font-medium">Activo</span>
            {% else %}
              <span class="px-2 py-1 text-xs rounded-full bg-red-500/20 text-red-300 font-medium">Inactivo</span>
            {% endif %}
          </td>
          <td class="px-4 py-3 text-center">
            <div class="inline-flex gap-2">
              {% if perfil.user.is_active %}
                <a href="{% url 'desactivar_arrendatario' perfil.user.id %}"
                   onclick="return confirm(' ¿Estás seguro de que quieres desactivar a {{ perfil.user.username }}?')"
                   class="px-3 py-2 text-sm font-medium rounded bg-red-600 hover:bg-red-500 text-white">
                   Desactivar
                </a>
              {% else %}
                <a href="{% url 'activar_arrendatario' perfil.user.id %}"
                   onclick="return confirm(' ¿Estás seguro de que quieres activar a {{ perfil.user.username }}?')"
                   class="px-3 py-2 text-sm font-medium rounded bg-green-600 hover:bg-green-500 text-white">
                   Activar
                </a>
              {% endif %}
              <a href="{% url 'editar_arrendatario' perfil.user.id %}"
                 class="px-3 py-2 text-sm font-medium rounded bg-indigo-600 hover:bg-indigo-500 text-white">
                 Editar
              </a>
            </div>
          </td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="6" class="px-4 py-6 text-center text-gray-400">No hay arrendatarios para este filtro.</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
