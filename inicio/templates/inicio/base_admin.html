{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{% block titulo %}Panel Admin{% endblock %}</title>
  <script src="https://cdn.tailwindcss.com"></script>
  {% block extra_head %}{% endblock %}
</head>
<body class="relative min-h-screen bg-gradient-to-br from-indigo-600 via-violet-700 to-purple-800 text-white">

  {% block ambient %}
    <div class="absolute inset-0 pointer-events-none -z-10">
      {# AquÃ­ puedes insertar efectos visuales o partÃ­culas #}
    </div>
  {% endblock %}

  <div class="flex min-h-screen">
    <!-- Sidebar -->
    <aside class="w-64 bg-gray-900 text-white flex flex-col overflow-y-auto">
      <div class="p-4 border-b border-gray-800 flex items-center justify-between">
        <img src="{% static 'inicio/img/logo.svg' %}" alt="Logo" class="h-8 w-auto">
        <span class="text-xl font-bold">Admin Pro</span>
      </div>

      <!-- Buscador -->
      <div class="p-4">
        <form action="{% url 'admin_buscar' %}" method="get" class="relative">
          <input name="q" type="text"
            value="{{ request.GET.q|default:'' }}"
            class="w-full bg-gray-800 text-white rounded-md pl-10 pr-4 py-2 text-sm
                   focus:outline-none focus:ring-2 focus:ring-indigo-500"
            placeholder="Buscar...">
          <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
            <svg class="h-5 w-5 text-gray-500" xmlns="http://www.w3.org/2000/svg"
                 viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd"
                d="M8 4a4 4 0 100 8 4 4 0 000-8zM2
                   8a6 6 0 1110.89 3.476l4.817
                   4.817a1 1 0 01-1.414
                   1.414l-4.816-4.816A6 6
                   0 012 8z" clip-rule="evenodd" />
            </svg>
          </div>
        </form>
      </div>

      <!-- NavegaciÃ³n principal -->
      <nav class="flex-1 px-2 mt-4 space-y-1">
        <a href="{% url 'dashboard_admin' %}"
           class="flex items-center px-4 py-2.5 text-sm font-medium rounded-lg
           {% if request.resolver_match.url_name == 'dashboard_admin' %}
             bg-gray-800 text-white
           {% else %}
             text-gray-300 hover:bg-gray-700 hover:text-white
           {% endif %}">
          ğŸ“Š Dashboard
        </a>
        <a href="{% url 'contratos_admin' %}"
           class="flex items-center px-4 py-2.5 text-sm font-medium rounded-lg
           {% if request.resolver_match.url_name == 'contratos_admin' %}
             bg-gray-800 text-white
           {% else %}
             text-gray-300 hover:bg-gray-700 hover:text-white
           {% endif %}">
          ğŸ“ Contratos Activos
        </a>
        <a href="{% url 'vencimientos_admin' %}"
           class="flex items-center px-4 py-2.5 text-sm font-medium rounded-lg
           {% if request.resolver_match.url_name == 'vencimientos_admin' %}
             bg-gray-800 text-white
           {% else %}
             text-gray-300 hover:bg-gray-700 hover:text-white
           {% endif %}">
          ğŸ“… Vencimientos (30d)
        </a>
        <a href="{% url 'pagos_admin' %}"
           class="flex items-center px-4 py-2.5 text-sm font-medium rounded-lg
           {% if request.resolver_match.url_name == 'pagos_admin' %}
             bg-gray-800 text-white
           {% else %}
             text-gray-300 hover:bg-gray-700 hover:text-white
           {% endif %}">
          ğŸ’³ Pagos Pendientes
        </a>
        <a href="{% url 'notificaciones_admin' %}"
           class="flex items-center px-4 py-2.5 text-sm font-medium rounded-lg
           {% if request.resolver_match.url_name == 'notificaciones_admin' %}
             bg-gray-800 text-white
           {% else %}
             text-gray-300 hover:bg-gray-700 hover:text-white
           {% endif %}">
          ğŸ”” Notificaciones (30d)
        </a>
      </nav>

      <!-- Perfil y logout -->
      <div class="mt-auto p-4 border-t border-gray-800 flex items-center space-x-3">
        <img src="{% static 'inicio/img/avatar.png' %}" class="h-8 w-8 rounded-full" alt="Avatar">
        <div>
          <p class="text-sm font-medium">{{ request.user.get_full_name|default:request.user.username }}</p>
          <form method="post" action="{% url 'logout' %}">
            {% csrf_token %}
            <button type="submit" class="text-xs text-red-400 hover:underline">Cerrar sesiÃ³n</button>
          </form>
        </div>
      </div>
    </aside>

    <!-- Contenido principal -->
    <main class="flex-1 overflow-y-auto p-6">
      <header class="mb-6">
        {% block encabezado %}{% endblock %}
      </header>
      <div class="max-w-7xl mx-auto">
        {% block contenido %}{% endblock %}
      </div>
    </main>
  </div>

  {% block extra_scripts %}
    <script>
      document.querySelectorAll('button[aria-controls]').forEach(button => {
        const target = document.getElementById(button.getAttribute('aria-controls'));
        const chevron = button.querySelector('svg:last-child');
        const expanded = button.getAttribute('aria-expanded') === 'true';
        if (expanded) {
          target.classList.remove('hidden');
          chevron.classList.add('rotate-180');
        }
        button.addEventListener('click', () => {
          const isExpanded = button.getAttribute('aria-expanded') === 'true';
          button.setAttribute('aria-expanded', String(!isExpanded));
          target.classList.toggle('hidden');
          chevron.classList.toggle('rotate-180');
        });
      });
    </script>
  {% endblock %}
</body>
</html>
